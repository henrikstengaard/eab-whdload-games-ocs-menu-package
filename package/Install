; EAB WHDLoad Games OCS Menu Package Install Script
; -------------------------------------------------
;
; Author: Henrik Noerfjand Stengaard
; Date: 2016-01-04
;
; This script extracts and installs zip archives for EAB WHDLoad Games OCS Menu Package.

echo "Installing HstWB Games..."
unzip -qq -o -x PACKAGEDIR:hstwb-games.zip -d SYSTEMDIR:Games/

echo "Installing Menu and WHDLoad drawers..."
unzip -qq -o -x PACKAGEDIR:menu-whdload-drawers.zip -d WORKDIR:

echo "Installing AGS2 Games Menu..."
unzip -qq -o -x PACKAGEDIR:ags2games-menu.zip -d WORKDIR:Menu/AGS2Games/
protect >NIL: WORKDIR:Menu/AGS2Games/AGS2 +rwe
protect >NIL: WORKDIR:Menu/AGS2Games/AGS2Helper +rwe
protect >NIL: WORKDIR:Menu/AGS2Games/AGS2Menu +rwe
IF NOT EXISTS "WORKDIR:Menu/AGS2Games/Music"
  makedir "WORKDIR:Menu/AGS2Games/Music" >NIL:
ENDIF

echo "Installing Menu WHDLoad Content..."
unzip -qq -o -x PACKAGEDIR:menu-whdload-content.zip -d WORKDIR:WHDLoad/Games/

; Add A-Games to user-assign, if it doesn't exist
search SYSTEMDIR:S/User-Assign "A-Games:" >NIL:
IF WARN 
	echo "Assign A-Games: DH1:WHDLoad/Games" >>SYSTEMDIR:S/User-Assign
ENDIF

; Add HD-Games to user assign, if it doesn't exist
search SYSTEMDIR:S/User-Assign "HD-Games:" >NIL:
IF WARN 
	echo "Assign HD-Games: DH1:HD-Games" >>SYSTEMDIR:S/User-Assign
ENDIF

; Add ags2 games menu dir to ags2menu.data, if it doesn't exist
search SYSTEMDIR:S/AGS2Menu.data "AGS2GamesMenuDir=" >NIL:
IF WARN 
	echo "AGS2GamesMenuDir=DH1:Menu/AGS2Games" >>SYSTEMDIR:S/AGS2Menu.data
ENDIF
